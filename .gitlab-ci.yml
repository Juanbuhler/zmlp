stages:
  - test
  - build

# SDK Jobs
pylib-linting:
  image: python:3.8
  stage: test
  script:
    - python -m pip install flake8
    - flake8 containers/plugins-py3-analysis
    - flake8 containers/plugins-py3-core
    - flake8 sdk/python

# Wallet Jobs
.wallet-frontend-base:
  image: node:12
  before_script:
    - cd services/wallet/app/frontend
    - npm install

wallet-frontend-lint:
  extends: .wallet-frontend-base
  stage: test
  script:
    - npx eslint ./src --quiet
    - npx stylelint '**/*.scss'

wallet-frontend-unit-test:
  extends: .wallet-frontend-base
  stage: test
  script:
    - npx jest --bail --silent --ci

wallet-container-build-validation:
  stage: test
  image: docker:18.09.8-dind
  services:
    - docker:18.09.8-dind
  script:
    - cd services/wallet
    - docker build --pull --no-cache .
